Imports CapaAccesoDatos
Imports MyGeneration.dOOdads
' Generated by MyGeneration Version # (1.3.0.9)

Public Class TipoDocumentoxAreasxAgencia 
    Inherits _TipoDocumentoxAreasxAgencia

    Private nIdtipDoc As Integer
    Private sIdarea As String
    Private sIdagencia As String
    Private sActivo As String
    Private sIdUser As String
    Private sFecha As String
    Public Property p_FechaR() As String
        Get
            Return sFecha
        End Get
        Set(ByVal value As String)
            sFecha = value
        End Set
    End Property

    Public Property p_IdUser() As String
        Get
            Return sIdUser
        End Get
        Set(ByVal value As String)
            sIdUser = value
        End Set
    End Property

    Public Property p_Activo() As String
        Get
            Return sActivo
        End Get
        Set(ByVal value As String)
            sActivo = value
        End Set
    End Property

    Public Property p_IdAgencia() As String
        Get
            Return sIdagencia
        End Get
        Set(ByVal value As String)
            sIdagencia = value
        End Set
    End Property

    Public Property p_IdArea() As String
        Get
            Return sIdarea
        End Get
        Set(ByVal value As String)
            sIdarea = value
        End Set
    End Property

    Public Property p_IdTipDoc() As Integer
        Get
            Return nIdtipDoc
        End Get
        Set(ByVal value As Integer)
            nIdtipDoc = value
        End Set
    End Property

    Public Sub insertaTipDocxAreaxAge(ByVal NuevoTipDocxAreaxAgencia As TipoDocumentoxAreasxAgencia)
        Dim tx As TransactionMgr
        tx = TransactionMgr.ThreadTransactionMgr
        Try
            tx.BeginTransaction()
            AddNew()
            With NuevoTipDocxAreaxAgencia
                IdTipoDocumento = .p_IdTipDoc
                IdArea = .p_IdArea
                IdAgencia = .p_IdAgencia
                Activo = .p_Activo
                IdUserR = .p_IdUser
                FechaR = .p_FechaR
            End With
            Save()
            tx.CommitTransaction()
        Catch ex As Exception
            tx.RollbackTransaction()
            TransactionMgr.ThreadTransactionMgrReset()
            Throw ex
        End Try



    End Sub
    Public Function obtTipDocxAreaxAge(ByVal sIdTipDoc As String) As DataTable
        Dim area As New Areas
        Dim agencia As New Agencias
        Dim nombrearea As String
        Dim nombreagencia As String
        Dim dtDetalle As New DataTable
        '-- filasque usaremos
        Dim drFilaDetalle As DataRow
        '-- end
        '-- seteamos  nuevas columnas que seran la columna nombre 
        Dim ColArea As New DataColumn
        Dim ColAgencia As New DataColumn

        ColArea.ColumnName = "Area"
        ColAgencia.ColumnName = "Agencia"
        ColArea.DataType = System.Type.GetType("System.String")
        ColAgencia.DataType = System.Type.GetType("System.String")
        '--fin--
        Where.IdTipoDocumento.Value = sIdTipDoc
        Where.IdTipoDocumento.Operator = WhereParameter.Operand.Equal
        If Query.Load Then
            dtDetalle.Columns.Add(ColArea)
            dtDetalle.Columns.Add(ColAgencia)
            For Each miFila As DataRow In DataTable.Rows
                nombrearea = area.EC_obtArea(miFila("IdArea"))
                nombreagencia = agencia.EC_obtAgencia(miFila("IdAgencia"))
                drFilaDetalle = dtDetalle.NewRow()
                drFilaDetalle(0) = nombrearea
                drFilaDetalle(1) = nombreagencia
                dtDetalle.Rows.Add(drFilaDetalle)
            Next
            Return dtDetalle
        Else
            Return Nothing
        End If
    End Function


End Class
